# ./pipeline-dir/my-pipe.yaml
context_parser: pypyr.parser.keyvaluepairs
steps:
  - name: pypyr.steps.py
    in:
      py: |
        hosts = ','.join(open('./hosts.txt').read().splitlines())
        logger('Loaded hosts :balloon:')
        logger(hosts)
        save('hosts')

  #- name: pypyr.steps.cmd
  #  comment: rustscan 
  #  run: False
  #  in:
  #    cmd: 
  #      run: docker run -it --rm --name rustscan rustscan/rustscan --accessible --greppable -a {hosts} 
  #      save: True

  - name: piper.steps.rustscan
    comment: run custom rustscan step!
    in:
      docker: True
      persist: True
      flags: '--greppable'

on_success:
  - name: pypyr.steps.contextsetf
    in:
      contextSetf:
        finished: True
